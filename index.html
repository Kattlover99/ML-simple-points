<html>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.8.4/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis@1.5.1/dist/tfjs-vis.umd.min.js"></script>
<script>
    function extractData(obj) {
        return { x: obj.Horsepower, y: obj.Miles_per_Gallon };
    }
    function removeErrors(obj) {
        return obj.x != null && obj.y != null;
    }
    async function runTF() {
        const jsonData = await fetch("cardata.json");
        let values = await jsonData.json();
        values = values.map(extractData).filter(removeErrors);
    }

    function tfPlot(values, surface) {
        tfvis.render.scatterplot(surface,
            { values: values, series: ['Original', 'Predicted'] },
            { xLabel: 'Horsepower', yLabel: 'MPG' });
    }
    // Map x values to Tensor inputs
    const inputs = values.map(obj => obj.x);
    // Map y values to Tensor labels
    const labels = values.map(obj => obj.y);

    // Convert inputs and labels to 2d tensors
    const inputTensor = tf.tensor2d(inputs, [inputs.length, 1]);
    const labelTensor = tf.tensor2d(labels, [labels.length, 1]);

    const inputMin = inputTensor.min();
    const inputMax = inputTensor.max();
    const labelMin = labelTensor.min();
    const labelMax = labelTensor.max();
    const nmInputs = inputTensor.sub(inputMin).div(inputMax.sub(inputMin));
    const nmLabels = labelTensor.sub(labelMin).div(labelMax.sub(labelMin));

    const model = tf.sequential();
    model.add(tf.layers.dense({ inputShape: [1], units: 1, useBias: true }));
    model.add(tf.layers.dense({ units: 1, useBias: true }));
</script>

</html>